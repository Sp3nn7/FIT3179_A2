{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "description": "A vertical box plot showing median and lower and upper quartiles of the distribution.",
    "data": {"url": "gtdb.csv"},

    "params":[
        {
        "name": "weapon_selection",
        "bind": {
            "input": "select",
            "options": [
                null,
                "Explosives", "Firearms", "Incendiary", "Melee",  "Unknown"
            ],
            "labels":[
                "Show All",
                "Explosives", "Firearms", "Incendiary", "Melee",  "Unknown"
            ],
            "name": "Weapon Type Selection: "
        }
                
        }
    ],



    "transform": [


        {
            "filter": {"and": [{"field": "iyear", "gte": 2014}, {"field": "iyear", "lte": 2017}]}
        },


        {"filter": "weapon_selection == null || datum.weaptype1_txt == weapon_selection"},

        {
            "window": [{
              "op": "rank",
              "as": "rank"
            }],
            "sort": [{ "field": "nkill", "order": "descending" }]
          }, {
            "filter": "datum.rank <= 6"
          }
    ],

    "mark": {
        "type":"boxplot"
    },

    "encoding": {
      "x": {"field": "weaptype1_txt", "type": "nominal", "title": "Weapon Used"},
      "color": {"field": "weaptype1_txt", "type": "nominal", "legend": null},
      "y": {
        "field": "nkill",
        "type": "quantitative",
        "title": "Amount of Fatalities",
        "scale": {"zero": false}
      }
    }
  }