{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {"url": "gtdb.csv"},


    "transform": 
    [
        {
            "filter": {"and": [{"field": "iyear", "equal": 2000}, {"field": "imonth", "equal": 8}]}
        },

        {
            "joinaggregate": 
            [
                {"op": "count", "field": "iday", "as": "dailyAttacksGrouped"}
                
            ],
            "groupby": ["iday"]
        },

        {
            "window": [{"op": "row_number", "as": "id"}],
            "sort": [{"field": "iday", "order": "ascending"}]
        },

        {"calculate": "ceil (datum.id / 30)", "as": "row"},
        {"calculate": "datum.id - datum.row * 30", "as": "col"}
    ],

        "mark": {
          "type": "circle",
          "filled": true,
          "tooltip": true,
          "stroke": "black",
          "strokeWidth": 0.7
        },
        "encoding": {
          "x": {"field": "col", "type": "ordinal", "axis": null},
          "y": {"field": "row", "type": "ordinal", "axis": null, "sort": "-y"},
          "color": {
            "field": "dailyAttacksGrouped",
            "type": "quantitative",
            "legend": {
              "orient": "right",
              "offset": 10,
              "labelOffset": 3,
              "titlePadding": 5,
              "titleFontSize": 20
            }
          },
          "size": {"value": 241},
          "tooltip": [
            {"field": "iyear", "type": "nominal", "title": "Year of Attack"},
            {"field": "imonth", "type": "nominal", "title": "Month of Attack"},
            {"field": "iday", "type": "nominal", "title": "Day of Attack"},
            {"field": "dailyAttacksGrouped", "type": "quantitative", "title": "Amount of attacks on this Date"}
            ]
        }
      }